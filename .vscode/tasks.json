{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    // for the documentation about the tasks.json format
    "version": "2.0.0",
    "tasks": [
      {
        "label": "Compile and install the library and compile all unit tests",
        "type": "shell",
        "command": "make all",
        "options": {
          "cwd": "${workspaceFolder}"
        },
        "problemMatcher": []
      },
      {
        "label": "Compile and install the library then execute one unit test",
        "type": "shell",
        "command": "./run_action.sh",
        "options": {
          "cwd": "${workspaceFolder}/.vscode"
        },
      },
      {
        "label": "Compile the library without installation tests",
        "type": "shell",
        "command": "make library",
        "options": {
          "cwd": "${workspaceFolder}"
        },
      },
      {
        "label": "Compile and build everything",
        "type": "shell",
        "command": "make all", // was make all
        "options": {
          // "cwd": "${workspaceFolder}"
        }
      },
      {
        "label": "View state",
        "type": "shell",
        "command": "./run_action.sh",
        "options": {
          "cwd": "${workspaceFolder}/.vscode"
        },
        "args": [
            "./view_result.sh",
            "${fileDirname}",
            "${fileBasenameNoExtension}",
            "${lineNumber}",
            "view_result",
            "recompile_optitrust_no",
            ""
        ]
      },
      {
        "label": "View diff",
        "type": "shell",
        "command": "./run_action.sh",
        "options": {
          "cwd": "${workspaceFolder}/.vscode"
        },
        "args": [
            "./view_result.sh",
            "${fileDirname}",
            "${fileBasenameNoExtension}",
            "${lineNumber}",
            "view_diff",
            "recompile_optitrust_no",
            /*"-dump-last",
            "5"*/
        ]
      },
      {
        "label": "Execute from intermediate state",
        "type": "shell",
        "command": "./run_action.sh",
        "options": {
          "cwd": "${workspaceFolder}/.vscode"
        },
        "args": [
            "./view_result_intermediate.sh",
            "${fileDirname}",
            "${fileBasenameNoExtension}",
            "${lineNumber}",
            "view_diff",
            "recompile_optitrust_no",
        ]
      },
      {
        "label": "Save intermediate state",
        "type": "shell",
        "command": "./run_action.sh",
        "options": {
          "cwd": "${workspaceFolder}/.vscode"
        },
        "args": [
            "./view_result_intermediate.sh",
            "${fileDirname}",
            "${fileBasenameNoExtension}",
            "${lineNumber}",
            "save_intermediate_state",
            "recompile_optitrust_no",
        ]
      },
      {
        "label": "View documentation for unit test",
        "type": "shell",
        "command": "make",
        "options": {
          "cwd": "${fileDirname}"
        }
        "args": [
            "${fileBasenameNoExtension}.doc",
        ]
      },
      {
        "label": "Compile and run current",
        "type":"shell",
        "command":"make ${fileBasenameNoExtension}.out",
        "options": {
          "cwd": "${fileDirname}"
        },
      },
      {
        "label": "Compile the full current folder",
        "type": "shell",
        "command": "make all",
        "options": {
          "cwd": "${fileDirname}"
        },
      },
      {
        "label": "Recompile and view state",
        "type": "shell",
        "command": "./run_action.sh",
        "options": {
          "cwd": "${workspaceFolder}/.vscode"
        },
        "args": [
            "./view_result.sh",
            "${fileDirname}",
            "${fileBasenameNoExtension}",
            "${lineNumber}",
            "view_result",
            "recompile_optitrust_yes",
            ""
        ]
      },
      {
        "label": "Recompile and view diff",
        "type": "shell",
        "command": "./run_action.sh",
        "options": {
          "cwd": "${workspaceFolder}/.vscode"
        },
        "args": [
            "./view_result.sh",
            "${fileDirname}",
            "${fileBasenameNoExtension}",
            "${lineNumber}",
            "view_diff",
            "recompile_optitrust_yes",
            ""
        ]
      },
      { // LATER: if current folder contains exp_out, we could also produce the .chk
        "label": "Recompile then compile and run current",
        "type":"shell",
        "command":"make optitrust; make ${fileBasenameNoExtension}.out",
        "options": {
          "cwd": "${fileDirname}"
        },
       "args": [
          "./view_result.sh",
          "${fileDirname}",
          "${fileBasenameNoExtension}",
          "${lineNumber}",
          "view_result",
          "recompile_optitrust_no",
          ""
        ]
    },
    {
      "label": "View diff",
      "type": "shell",
      "command": "./run_action.sh",
      "options": {
        "cwd": "${workspaceFolder}/.vscode"
      },
      "args": [
        "./view_result.sh",
        "${fileDirname}",
        "${fileBasenameNoExtension}",
        "${lineNumber}",
        "view_diff",
        "recompile_optitrust_no",
        /*"-dump-last",
        "5"*/
      ]
    },
    {
      "label": "Compile and run current",
      "type": "shell",
      "command": "make ${fileBasenameNoExtension}.out",
      "options": {
        "cwd": "${fileDirname}"
      }
    },
    {
      "label": "Compile the full current folder",
      "type": "shell",
      "command": "make all",
      "options": {
        "cwd": "${fileDirname}"
      }
    },
    {
      "label": "Recompile and view state",
      "type": "shell",
      "command": "./run_action.sh",
      "options": {
        "cwd": "${workspaceFolder}/.vscode"
      },
      "args": [
        "./view_result.sh",
        "${fileDirname}",
        "${fileBasenameNoExtension}",
        "${lineNumber}",
        "view_result",
        "recompile_optitrust_yes",
        ""
      ]
    },
    {
      "label": "Recompile and view diff",
      "type": "shell",
      "command": "./run_action.sh",
      "options": {
        "cwd": "${workspaceFolder}/.vscode"
      },
      "args": [
        "./view_result.sh",
        "${fileDirname}",
        "${fileBasenameNoExtension}",
        "${lineNumber}",
        "view_diff",
        "recompile_optitrust_yes",
        ""
      ]
    },
    {
      "label": "Recompile then compile and run current",
      "type": "shell",
      "command": "make optitrust; make ${fileBasenameNoExtension}.out",
      "options": {
        "cwd": "${fileDirname}"
      }
    },
    {
      "label": "Compile the full current folder",
      "type": "shell",
      "command": "make all",
      "options": {
        "cwd": "${fileDirname}"
      }
    },
    {
      "label": "First recompile optitrust then compile the full current folder",
      "type": "shell",
      "command": "make optitrust; make all",
      "options": {
        "cwd": "${fileDirname}"
      }
    },
    {
      "label": "Start the inotifywait watch",
      "type": "shell",
      "command": "./.vscode/watch.sh "
    },
    {
      "label": "Execute transformation script (dump trace)",
      "type": "shell",
      "command": "./.vscode/view_result.sh",
      "args": [
        "${fileDirname}",
        "${fileBasenameNoExtension}",
        "${lineNumber}",
        "-dump-trace"
      ]
    }
  ]
}
